var push={subscribeText:"Show Notifications",unsubscribeText:"Disable Notifications",toggleSubscription:function(){"true"==document.getElementById("pushBtn").getAttribute("aria-pressed")?push.unsubscribe():push.subscribe()},toggleServerSubscription:function(a,c){document.getElementById("pushBtn");document.getElementById("pushLabel");var d=JSON.stringify(a),b={"Content-Type":"application/json"};"subscribe"==c?fetch("/subscription",{method:"PUT",headers:b,body:d}):fetch("/subscription",{method:"DELETE",
headers:b,body:d})},subscribe:function(){var a=document.getElementById("pushBtn"),c=document.getElementById("pushLabel");a.setAttribute("aria-pressed",!0);c.textContent=push.unsubscribeText;navigator.serviceWorker.ready.then(function(a){a.pushManager.subscribe({userVisibleOnly:!0}).then(function(a){push.toggleServerSubscription(a,"subscribe")})["catch"](function(a){console.error("subscription error: ",a);c.textContent=push.subscribeText})})},unsubscribe:function(){navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){var d=
document.getElementById("pushBtn"),b=document.getElementById("pushLabel");d.setAttribute("aria-pressed",!1);b.textContent=push.subscribeText;push.toggleServerSubscription(a,"unsubscribe");a.unsubscribe().then(function(){b.textContent=push.subscribeText})["catch"](function(a){console.error("unsubscribe error: ",a)})})})}};
push.init=function(){if("serviceWorker"in navigator&&"denied"!==Notification.permission&&"PushManager"in window){var a=document.getElementById("settingsPane"),c=document.getElementById("settingsFallback"),d=document.createElement("br"),b=document.createElement("article");b.innerHTML='<div id="pushBtn" tabindex="0" role="button" aria-pressed="false" aria-describeby="pushLabel"></div>\n      <p id="pushLabel">'+push.subscribeText+"</p>";a.removeChild(c);a.appendChild(d);a.appendChild(b);var a=document.getElementById("pushBtn"),
e=document.getElementById("pushLabel");a.addEventListener("click",push.toggleSubscription);a.addEventListener("keydown",function(a){"Enter"==a.key&&push.toggleSubscription()});navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){a?push.toggleSubscription():e.content=push.subscribeText})})}}();
