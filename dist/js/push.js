var push={subscribeText:"Show Notifications",unsubscribeText:"Disable Notifications",toggleSubscription:function(){document.getElementById("pushBtn").checked?push.unsubscribe():push.subscribe()},toggleServerSubscription:function(a,d){var b=document.getElementById("pushBtn"),c=document.querySelector("#pushBtn ~ label"),e=JSON.stringify(a),f={"Content-Type":"application/json"};"subscribe"==d?(b.setAttribute("checked",!0),c.textContent=push.unsubscribeText,fetch("/subscription",{method:"PUT",headers:f,
body:e})):(b.removeAttribute("checked"),c.textContent=push.subscribeText,fetch("/subscription",{method:"DELETE",headers:f,body:e}))},subscribe:function(){document.getElementById("pushBtn");var a=document.querySelector("#pushBtn ~ label");navigator.serviceWorker.ready.then(function(d){d.pushManager.subscribe({userVisibleOnly:!0}).then(function(b){push.toggleServerSubscription(b,"subscribe")})["catch"](function(b){console.error("subscription error: ",b);a.textContent=push.subscribeText})})},unsubscribe:function(){navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){var b=
document.querySelector("#pushBtn ~ label");push.toggleServerSubscription(a,"unsubscribe");a.unsubscribe().then(function(){b.textContent=push.subscribeText})["catch"](function(a){console.error("unsubscribe error: ",a)})})})}};
push.init=function(){if("serviceWorker"in navigator&&"denied"!==Notification.permission&&"PushManager"in window){var a=document.getElementsByTagName("header")[0],d=document.createElement("br"),b=document.createElement("div");b.innerHTML='<input type="checkbox" id="pushBtn" hidden><label for="pushBtn">'+push.subscribeText+"</label>";a.appendChild(d);a.appendChild(b);document.getElementById("pushBtn");var c=document.querySelector("#pushBtn ~ label");c.addEventListener("click",push.toggleSubscription);
c.addEventListener("touchend",push.toggleSubscription);navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){a?push.toggleSubscription():c.content=push.subscribeText})})}}();
