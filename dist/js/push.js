var push={subscribeText:"Show Notifications",unsubscribeText:"Disable Notifications",toggleSubscription:function(){"true"==document.getElementById("pushBtn").getAttribute("aria-pressed")?push.unsubscribe():push.subscribe()},toggleServerSubscription:function(a,b){document.getElementById("pushBtn");document.getElementById("pushLabel");a=JSON.stringify(a);var d={"Content-Type":"application/json"};"subscribe"==b?fetch("/subscription",{method:"PUT",headers:d,body:a}):fetch("/subscription",{method:"DELETE",
headers:d,body:a})},subscribe:function(){var a=document.getElementById("pushBtn"),b=document.getElementById("pushLabel");a.setAttribute("aria-pressed",!0);b.textContent=push.unsubscribeText;navigator.serviceWorker.ready.then(function(a){a.pushManager.subscribe({userVisibleOnly:!0}).then(function(a){push.toggleServerSubscription(a,"subscribe")}).catch(function(a){console.error("subscription error: ",a);b.textContent=push.subscribeText})})},unsubscribe:function(){navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){var b=
document.getElementById("pushBtn"),c=document.getElementById("pushLabel");b.setAttribute("aria-pressed",!1);c.textContent=push.subscribeText;push.toggleServerSubscription(a,"unsubscribe");a.unsubscribe().then(function(){c.textContent=push.subscribeText}).catch(function(a){console.error("unsubscribe error: ",a)})})})}};
push.init=function(){if("serviceWorker"in navigator&&"denied"!==Notification.permission&&"PushManager"in window){var a=document.getElementById("settingsPane"),b=document.getElementById("settingsFallback"),d=document.createElement("br"),c=document.createElement("article");c.innerHTML='<div id="pushBtn" tabindex="0" role="button" aria-pressed="false" aria-describeby="pushLabel"></div>\n      <p id="pushLabel">'+push.subscribeText+"</p>";a.removeChild(b);a.appendChild(d);a.appendChild(c);a=document.getElementById("pushBtn");
var e=document.getElementById("pushLabel");a.addEventListener("click",push.toggleSubscription);a.addEventListener("keydown",function(a){"Enter"==a.key&&push.toggleSubscription()});navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){a?push.toggleSubscription():e.content=push.subscribeText})})}}();
